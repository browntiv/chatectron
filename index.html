<head>
    <title>Chat application</title>
    <script>
        
    </script>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css">
    <link rel="stylesheet" type="" href="app.css">
    <script>
        window.$ = require("jquery");
        $(function(){
        var socket = require('socket.io-client')('http://localhost:3000');
        var $left = $('.left');
        var $right = $('.right');
        var $name = $('#name');
        var $sendname = $('#sendname');
        var options = [{
            title:"New client",
            body:"Someone has connected",
            icon: path.join(__dirname,"icon.png")
        }]
        function showNotify(){
            new Notification(options[0].title,options[0]);
        }
        $left.hide();
        $right.hide();

        $name.keydown(function(e){
            if(e.keyCode==13){
                socket.emit('new user',$name.val(),function(data){
                    if(data){
                        $('#login').hide(500);
                        $left.show();
                        $right.show();
                        $('#message').fadeIn();
                    }
                })
            }
        })
        
        $('textarea').keydown(function(e){
            if(e.keyCode==13){
                socket.emit('send message',$('#message').val());
                $('#message').val('');
                $('#message').focus();
                return false;
            }
        })
        $('#send').click(function(){
            socket.emit('send message',$('#message').val());
            $('#message').val('');
            $('#message').focus();
        })

        socket.on('new message',function(data){
            $('.table').append('<tr class="active"><td><strong>'+data.user+'</strong>: '+data.msg+'</td></tr>');
    	})
        socket.on('get users',function(data){
            var html ='';
            for(i=0;i<data.length;i++){
                html += '<li><div id="pic"></div><div id="username">'+data[i]+'</div></li>';
            }
            $('#onlines').html(html);
            showNotify();
        })
	    })
        
	</script>
</head>

<body>
        <div id="login" class="login page">
            <div class="form">
                <h3 class="title">What's your nickname?</h3>
                <input class="usernameInput" type="text" maxlength="14" id="name" />
            </div>
        </div>
        <div class="left">
            <div id="menageWindow">
                <div id="minimize" onclick="Minimize();"></div>
                <div id="maximize" onclick="Maximize();">
                    <div id="maxicon"></div>
                </div>
                <div id="close" onclick="Close();"></div>
            </div>
            <div class="people default-skin">
                <ul class="list-group" style="overflow:auto;" id="onlines">

                </ul>
            </div>
        </div>
        <div class="right">
            <div id="messages">
                <table class="table table-striped table-hover">
                    <tr class="success">
                    </tr>
                </table>
            </div>
            <div id="input">
                <textarea type="textarea" id="message" style="resize:none;" placeholder="Write somethink.." class="form-control input-lg"></textarea>
                <div id="send">
                    <strong>SEND</strong>
                </div>
            </div>

        </div>
</body>

</html>